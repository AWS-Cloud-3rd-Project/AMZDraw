<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <script src="https://js.tosspayments.com/v1/order-widget"></script>
</head>
<body>
<!-- 할인 쿠폰 -->
<div>
    <input type="checkbox" id="coupon-box" />
    <label for="coupon-box"> 5,000원 쿠폰 적용 </label>
</div>
<!-- 결제 UI, 이용약관 UI 영역 -->
<div id="order-method"></div>
<div id="agreement"></div>
<!-- 결제하기 버튼 -->
<button id="order-button">결제하기</button>

<script>
    const coupon = document.getElementById("coupon-box");
    const button = document.getElementById("order-button");

    // 구매자의 고유 아이디를 불러와서 customerKey로 설정하세요.
    // 이메일・전화번호와 같이 유추가 가능한 값은 안전하지 않습니다.
    const widgetClientKey = "test_ck_vZnjEJeQVxb5mJnxvmRD8PmOoBN0";
    const customerKey = "is_XEZl30wM074V2KzK11";
    const paymentWidget = PaymentWidget(widgetClientKey, customerKey); // 회원 결제
    // const paymentWidget = PaymentWidget(widgetClientKey, PaymentWidget.ANONYMOUS) // 비회원 결제

    const paymentMethodWidget = paymentWidget.renderPaymentMethods(
      "#order-method",
      { value: 10000000 },
      { variantKey: "DEFAULT" }
    );

    paymentWidget.renderAgreement(
      "#agreement",
      { variantKey: "AGREEMENT" }
    );

    coupon.addEventListener("change", function () {
      if (coupon.checked) {
        paymentMethodWidget.updateAmount(amount - 5000);
      } else {
        paymentMethodWidget.updateAmount(amount);
      }
    });

    button.addEventListener("click", function () {
      // 결제를 요청하기 전에 orderId, amount를 서버에 저장하세요.
      // 결제 과정에서 악의적으로 결제 금액이 바뀌는 것을 확인하는 용도입니다.
      paymentWidget.requestPayment({
        orderId: "test_821312312123",
        orderName: "시그니엘",
        successUrl: window.location.origin + "/api/v1/order/success",
        failUrl: window.location.origin + "/api/v1/order/fail",
        customerEmail: "hjp@google.com",
        customerName: "홍준표"
      });
    });
</script>
</body>
</html>